$(function() {




    // $('input[type="tel"]').mask("+7(999) 999-99-99");


    // var radioValue = number_format($(this).val(), 0, ',', ' ');


    function number_format(number, decimals, dec_point, thousands_sep) {
        number = (number + '').replace(/[^0-9+\-Ee.]/g, '');
        var n = !isFinite(+number) ? 0 : +number,
            prec = !isFinite(+decimals) ? 0 : Math.abs(decimals),
            sep = (typeof thousands_sep === 'undefined') ? ',' : thousands_sep,
            dec = (typeof dec_point === 'undefined') ? '.' : dec_point,
            s = '',
            toFixedFix = function(n, prec) {
                var k = Math.pow(10, prec);
                return '' + (Math.round(n * k) / k)
                    .toFixed(prec);
            };
        // Fix for IE parseFloat(0.55).toFixed(0) = 0;
        s = (prec ? toFixedFix(n, prec) : '' + Math.round(n))
            .split('.');
        if (s[0].length > 3) {
            s[0] = s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g, sep);
        }
        if ((s[1] || '')
            .length < prec) {
            s[1] = s[1] || '';
            s[1] += new Array(prec - s[1].length + 1)
                .join('0');
        }
        return s.join(dec);
    }




    //SEND FORMS 
    var dwl_price_adress = '/download';
    var dwl_price_name = '';
    $('.dwl_price').on('click', function(){
        dwl_price_adress = $(this).attr('data-download');
        dwl_price_name = $(this).attr('data-name');        
    });

    $("#phone input").inputmask("+7(999)999-99-99");
    $("#phone2 input").inputmask("+7(999)999-99-99");
    $("#phone3 input").inputmask("+7(999)999-99-99");
    $('.section4__form, .section1__form, .sign_up_form').on('submit', function (e) {

        e.preventDefault();
        var $this = $(this);
        //SECTION4 FORM
        if ($this.hasClass('section4__form')) {
            //- Валидация ------------------------------
            var name = $('#name input').val();
            var phone = $('#phone input').val();
            var token_var = $this.find('[name="_token"]').val();
            var patternPhone = /^(\s*)?(\+)?([- _():=+]?\d[- _():=+]?){11,14}(\s*)?$/;
            var successPhone = false;

            //- Проверка на пустое поле
            if (name.length !== 0) {
                $('#name .input-block__message').text('');
            } else {
                $('#name .input-block__message').text('Введите имя');
            };

            //- Проверка на пустое поле
            if (phone.length !== 0) {
                $('#phone .input-block__message').text('');
                if (phone.search(patternPhone) == 0) {
                    $('#phone .input-block__message').text('');
                    successPhone = true;
                } else {
                    $('#phone .input-block__message').text('Введите корректный номер телефона');
                }
            } else {
                $('#phone .input-block__message').text('Введите номер телефона');
            }

            //- Проверка на соответсвие всех полей необходимым проверкам 
            if (name.length !== 0 && successPhone == true) {
                $this[0].reset();

                $.ajax({
                    url: $this.attr('action'), // Файл в который отправить данные 
                    type: 'POST', // Метод отправки данных
                    data: {
                        _token: token_var,
                        sender_name: name,
                        sender_phone: phone
                    }, // Получить все данные формы  https://ruseller.com/jquery?id=8
                    success: function (data) { // Функция выполняемая в случае успешной отправки формы
                        response = $.parseJSON(data);
                        console.log(response.status);
                        console.log(response.message);
                        $('#thank_claim_link').click();

                    },
                    error: function (jqXHR, exception) {
                        response = $.parseJSON(jqXHR.responseText);
                        var name_error_serv = response.errors.sender_name[0];
                        var tel_error_serv = response.errors.sender_phone[0];
                        if (name_error_serv) {
                            $('#name .input-block__message').text(name_error_serv);
                        };
                        if (tel_error_serv) {
                            $('#phone .input-block__message').text(tel_error_serv);
                        };
                    }
                });
            };
        }


        //CALLBACK FORM********
        if ($this.hasClass('section1__form')) {

            //- Валидация ------------------------------
            var name = $('#name2 input').val();
            var phone = $('#phone2 input').val();
            var token_var = $this.find('[name="_token"]').val();
            var patternPhone = /^(\s*)?(\+)?([- _():=+]?\d[- _():=+]?){11,14}(\s*)?$/;
            var successPhone = false;

            //- Проверка на пустое поле
            if (name.length !== 0) {
                $('#name2 .input-block__message').text('');
            } else {
                $('#name2 .input-block__message').text('Введите имя');
            };

            //- Проверка на пустое поле
            if (phone.length !== 0) {
                $('#phone2 .input-block__message').text('');
                if (phone.search(patternPhone) == 0) {
                    $('#phone2 .input-block__message').text('');
                    successPhone = true;
                } else {
                    $('#phone2 .input-block__message').text('Введите корректный номер телефона');
                }
            } else {
                $('#phone2 .input-block__message').text('Введите номер телефона');
            }

            //- Проверка на соответсвие всех полей необходимым проверкам 
            if (name.length !== 0 && successPhone == true) {
                $this[0].reset();

                $.ajax({
                    url: $this.attr('action'), // Файл в который отправить данные 
                    type: 'POST', // Метод отправки данных
                    data: {
                        _token: token_var,
                        sender_name: name,
                        sender_phone: phone
                    }, // Получить все данные формы  https://ruseller.com/jquery?id=8
                    success: function (data) { // Функция выполняемая в случае успешной отправки формы
                        response = $.parseJSON(data);
                        console.log(response.status);
                        console.log(response.message);
                        $.fancybox.close();
                        $('#thank_claim_link').click();

                    },
                    error: function (jqXHR, exception) {
                        response = $.parseJSON(jqXHR.responseText);
                        var name_error_serv = response.errors.sender_name[0];
                        var tel_error_serv = response.errors.sender_phone[0];
                        if (name_error_serv) {
                            $('#name2 .input-block__message').text(name_error_serv);
                        };
                        if (tel_error_serv) {
                            $('#phone2 .input-block__message').text(tel_error_serv);
                        };
                    }
                });
            };

        }

        //SIGN UP FORM ****************
        if ($this.hasClass('sign_up_form')) {

            //- Валидация ------------------------------
            var downloading = 'Скачивание прайса';
            var name = $('#name3 input').val();
            var email = $('#email3 input').val();
            var phone = $('#phone3 input').val();
            var token_var = $this.find('[name="_token"]').val();
            var patternEmail = /^[\.a-z0-9_-]+@[a-z0-9-]+\.([a-z]{1,6}\.)?[a-z]{2,6}$/i;
            var successEmail = false;

            //- Проверка на пустое поле
            if (name.length !== 0) {
                $('#name3 .input-block__message').text('');
            } else {
                $('#name3 .input-block__message').text('Введите имя');
            };

            //- Проверка на пустое поле
            if (phone.length !== 0) {
                $('#phone3 .input-block__message').text('');
                if (phone.search(patternPhone) == 0) {
                    $('#phone3 .input-block__message').text('');
                    successPhone = true;
                } else {
                    $('#phone3 .input-block__message').text('Введите корректный номер телефона');
                }
            } else {
                $('#phone3 .input-block__message').text('Введите номер телефона');
            }
            //- Проверка на пустое поле
            if (email.length !== 0) {
                $('#email3 .input-block__message').text('');
                if (email.search(patternEmail) == 0) {
                    $('#email3 .input-block__message').text('');
                    successEmail = true;
                } else {
                    $('#email3 .input-block__message').text('Введите корректный email');
                }
            } else {
                $('#email3 .input-block__message').text('Введите ваш email');
            }
            //- Проверка на соответсвие всех полей необходимым проверкам 
            if (name.length !== 0 && successPhone == true && successEmail == true) {
                $this[0].reset();

                $.ajax({
                    url: $this.attr('action'), // Файл в который отправить данные 
                    type: 'POST', // Метод отправки данных
                    data: {
                        _token: token_var,
                        downloading: downloading + ' ' + dwl_price_name,
                        sender_name: name,
                        sender_email: email,
                        sender_phone: phone
                    }, // Получить все данные формы  https://ruseller.com/jquery?id=8
                    success: function (data) { // Функция выполняемая в случае успешной отправки формы
                        response = $.parseJSON(data);
                        console.log(response.status);
                        console.log(response.message);
                        $.fancybox.close();

                        var link = document.createElement('a');
                        link.setAttribute('href', dwl_price_adress);
                        link.setAttribute('download', 'price');
                        link.click();

                        console.log('test download');
                        console.log('dynamic path dowload' + dwl_price_adress)
                        console.log('dynamic name dowload' + downloading+' '+ dwl_price_name)
                    },
                    error: function (jqXHR, exception) {
                        response = $.parseJSON(jqXHR.responseText);
                        var name_error_serv = response.errors.sender_name[0];
                        var tel_error_serv = response.errors.sender_phone[0];
                        if (name_error_serv) {
                            $('#name3 .input-block__message').text(name_error_serv);
                        };
                        if (tel_error_serv) {
                            $('#phone3 .input-block__message').text(tel_error_serv);
                        };
                        $('#email3 .input-block__message').text(response.errors.email);
                        console.log(response.errors);
                    }
                });
            };

        }



    });








});


$('.footer__block-form').on('submit', function (e) {
    e.preventDefault();
    var $this = $(this);

    //- Валидация ------------------------------
    var token_var = $this.find('[name="_token"]').val();
    var email = $('#email input').val();
    var chack_box_var = $this.find('[name="accepted"]').val();
    var chack_box_chached = $('#check').is(':checked');
    var patternEmail = /^[\.a-z0-9_-]+@[a-z0-9-]+\.([a-z]{1,6}\.)?[a-z]{2,6}$/i;
    var successEmail = false;

    //- Проверка на пустое поле
    if (email.length !== 0) {
        $('#email .input-block__message').text('');
        if (email.search(patternEmail) == 0) {
            $('#email .input-block__message').text('');
            successEmail = true;
        } else {
            $('#email .input-block__message').text('Введите корректный email');
        }
    } else {
        $('#email .input-block__message').text('Введите ваш email');
    }
    
    if (chack_box_chached == true){
        $('.checkbox-custom').removeClass('empty_check');
    }else{
        $('.checkbox-custom').addClass('empty_check');
        
    }

    //- Проверка на соответсвие всех полей необходимым проверкам 
    if (successEmail == true && chack_box_chached == true) {
        $this[0].reset();

        $.ajax({
            url: $this.attr('action'), // Файл в который отправить данные 
            type: 'POST', // Метод отправки данных
            data: {
                _token: token_var,
                email: email,
                accepted: chack_box_var
            }, // Получить все данные формы  https://ruseller.com/jquery?id=8
            success: function (data) { // Функция выполняемая в случае успешной отправки формы
                response = $.parseJSON(data);
                if (response.message == 'You subscribe successfully'){
                    $('#thank_mail_link').click();
                } else if (response.message == 'This email already taken') {
                    $('#email .input-block__message').text('email уже существует');
                }
                console.log('success');
                  
            },
            error: function (jqXHR, exception){
                response = $.parseJSON(jqXHR.responseText);
                $('#email .input-block__message').text(response.errors.email);
            } 
        });
    }
});
$('.checkbox-custom').on('click', function(){
    $('.checkbox-custom').removeClass('empty_check');
})
$(".modalbox").fancybox();

if ($('main').hasClass('galery-page')) {
    var slideTime = 3000;
    var swiper = new Swiper('.swiper-container', {
        slidesPerView: 3,
        slidesPerGroup: 3,
        centeredSlides: false,
        loop: false,
        initialSlide: 1,
        breakpoints: {
            150: {
                slidesPerView: 1,
                slidesPerGroup: 1,
                initialSlide: 0,
            },
            650: {
                slidesPerView: 2,
                slidesPerGroup: 1,
                initialSlide: 0,
            },
            1100: {
                slidesPerView: 3,
                initialSlide: 0,
            }
        },
        autoplay: {
            delay: slideTime,
            disableOnInteraction: false,
        },
        pagination: {
            el: '.swiper-pag',
            clickable: true,
            renderBullet: function (index, className) {
                return '<span class="' + className + '"><svg id="svg" width="18" height="18" viewport="0 0 100 100" version="1.1" xmlns="http://www.w3.org/2000/svg"><circle r="5" cx="9" cy="9" fill="black" stroke-dasharray="40" stroke-dashoffset="0"></circle><circle id="bar" r="8" cx="9" cy="9" fill="transparent" stroke-dasharray="50" stroke-dashoffset="0"></circle></svg></span>';
            },
        },
        navigation: {
            nextEl: '.swiper-button-next',
            prevEl: '.swiper-button-prev',
        },
    });

    $(window).on('load', function () {
        $('.swiper-pagination-bullet #svg #bar').css('stroke-dashoffset', 50);
        $('.swiper-pagination-bullet-active #svg #bar').css('stroke-dashoffset', 0);
    });
    swiper.on('init', function () {
        $('.swiper-pagination-bullet #svg #bar').css('stroke-dashoffset', 50);
        $('.swiper-pagination-bullet-active #svg #bar').css('stroke-dashoffset', 0);
    });
    swiper.on('slideChangeTransitionEnd', function () {
        $('.swiper-pagination-bullet #svg #bar').css('stroke-dashoffset', 50);
        $('.swiper-pagination-bullet-active #svg #bar').css('stroke-dashoffset', 0);
    })

    $('.section1__tabs-buttons-el').on('click', function () {
        $('.section1__tabs-buttons-el').removeClass('active');
        $(this).addClass('active');
        $('.section1__tabs-content-el').removeClass('active');
        $('.section1__tabs-content-el[data-tab=' + $(this).attr('data-tab') + ']').addClass('active');
    })
}



$(function() {
   $(document).on("mouseenter ", ".catalog__item-nav-btn", function(e) {
      e.preventDefault();
      let item = $(this).closest(".catalog__item");
      let numPhoto = $(this).data("photo");
      let figure = item.find(".catalog__item-gallery").find('[data-photo="' + numPhoto + '"]');
      item.find("[data-photo]").removeClass("cover_active");
      $(figure).addClass("cover_active")
  });
});


if ($('main').hasClass('home-page')) {
    $('.section3__el-hover-el').on('mouseover', function () {
        var link = $(this).attr('data-src');
        $(this).parents('.section3__el-img').find('img').attr('src', link);
    });

}


if ($('main').hasClass('ourwork-page')) {
    $('[data-fancybox="ourworks_images"]').fancybox({
        buttons: [
            'zoom',
            'close'
        ],
    });
    $(window).on('load resize', function(){
        if ($(window).width() >= 1352){
            let items_number = $('.ourworks__item').length;

    
            if(items_number >= 6){
                $('.ourworks__item:nth-child(6n-5)').addClass('type6_1');
                $('.ourworks__item:nth-child(6n-4)').addClass('type6_2');
                $('.ourworks__item:nth-child(6n-3)').addClass('type6_3');
                $('.ourworks__item:nth-child(6n-2)').addClass('type6_4');
                $('.ourworks__item:nth-child(6n-1)').addClass('type6_5');
                $('.ourworks__item:nth-child(6n)').addClass('type6_6');
                //КЛОНИРУЕМ КАРТИНКИ ЧТО БЫ НЕ БЫЛО ПУСТЫХ МЕСТ
                let round = Math.ceil(items_number / 6);
                let shortage = 6*round - items_number;
                for(i=1; i<=shortage; i++) {
                    $('.ourworks__item:nth-child('+i+')').clone().appendTo('.ourworks .swiper-wrapper').removeClass().addClass('ourworks__item').addClass('clone').addClass('type6_'+(6 - shortage + i)+'');
                }   
            }
        }


    });


    //SWIPER
    $(window).on('load', function () {
        setTimeout(function () {
            let mySwiperMain = new Swiper('.ourworks', {
                init: true,
                width: 350,
                speed: 500,
                loop: false,
                slidesPerView: 'auto',
                initialSlide: 0,
                direction: "horizontal",
                allowTouchMove: true,
                breakpoints: {
                    825: {
                        allowTouchMove: false
                    }
                }

            });
        }, 500)
 
    });
}



//# sourceMappingURL=scripts.min.js.map
